---
  title: 'ä¸€ä¸ª`node_modules`å¼•å‘çš„ç¿»è½¦ç°åœº'
  date: '2020-08-28T15:56:01Z'
  update: '2020-12-03T09:52:22Z'
  comments: 0
  url: 'https://api.github.com/repos/shanejixx/shanejixx.github.io/issues/32'
  tags: ["Bug","Node"]
---

ä½¿ç”¨å¾®å‰ç«¯æ”¹é€ é¡¹ç›®æ—¶ï¼Œä¸çŸ¥é“ä½œäº†ä»€ä¹ˆéªšæ“ä½œå¯¼è‡´é¡¹ç›®åœ¨ç¼–è¯‘é˜¶æ®µå¤±è´¥ï¼Œå¯¼è‡´å¯åŠ¨ä¸äº†ã€‚ç›¸åŒç³»ç»Ÿï¼Œç›¸åŒæœºå™¨ï¼Œç›¸åŒç¯å¢ƒä¸‹åªæœ‰æˆ‘çš„ç”µè„‘è·‘ä¸èµ·æ¥ï¼é‡è£…é¡¹ç›®ï¼Œé‡è£…ç¯å¢ƒï¼Œé‡è£…ç³»ç»Ÿï¼Œå‰åæŠ˜è…¾äº†è®¸ä¹…æ‰¾åˆ°äº†é—®é¢˜æ‰€åœ¨ï¼Œä½œäºé‡Šæ€€ï¼

å½“ç„¶è¿™å¿…å®šä¸æ˜¯ä»€ä¹ˆå¶ç„¶äº‹ä»¶ï¼Œä¸€å®šæ˜¯ä»€ä¹ˆå·§åˆæ‰€é€ æˆçš„å¿…ç„¶ç»“æœï¼ğŸ¤”

---

## èƒŒæ™¯

`yarn start` æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š

```js
lerna notice cli v3.22.1
lerna info Executing command in 4 packages: "yarn run dev"
lerna ERR! yarn run dev exited 1 in 'home-app'
lerna ERR! yarn run dev stdout:
$ react-app-rewired start
info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.

lerna ERR! yarn run dev stderr:

There might be a problem with the project dependency tree.
It is likely not a bug in Create React App, but something you need to fix locally.

The react-scripts package provided by Create React App requires a dependency:

  "babel-eslint": "10.1.0"

Don't try to install it manually: your package manager does it automatically.
However, a different version of babel-eslint was detected higher up in the tree:

  E:\node_modules\babel-eslint (version: 10.0.3)

Manually installing incompatible versions is known to cause hard-to-debug issues.

If you would prefer to ignore this check, add SKIP_PREFLIGHT_CHECK=true to an .env file in your project.
That will permanently disable this message but you might encounter other issues.

To fix the dependency tree, try following the steps below in the exact order:

  1. Delete package-lock.json (not package.json!) and/or yarn.lock in your project folder.
  2. Delete node_modules in your project folder.
  3. Remove "babel-eslint" from dependencies and/or devDependencies in the package.json file in your project folder.
  4. Run npm install or yarn, depending on the package manager you use.

In most cases, this should be enough to fix the problem.
If this has not helped, there are a few other things you can try:

  5. If you used npm, install yarn (http://yarnpkg.com/) and repeat the above steps with it instead.
     This may help because npm has known issues with package hoisting which may get resolved in future versions.

  6. Check if E:\node_modules\babel-eslint is outside your project directory.
     For example, you might have accidentally installed something in your home folder.

  7. Try running npm ls babel-eslint in your project folder.
     This will tell you which other package (apart from the expected react-scripts) installed babel-eslint.

If nothing else helps, add SKIP_PREFLIGHT_CHECK=true to an .env file in your project.
That would permanently disable this preflight check in case you want to proceed anyway.

P.S. We know this message is long but please read the steps above :-) We hope you find them helpful!

error Command failed with exit code 1.

lerna ERR! yarn run dev exited 1 in 'home-app'
lerna WARN complete Waiting for 3 child processes to exit. CTRL-C to exit immediately.
error Command failed with exit code 1.
info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.
```

---

æˆ‘ä¸¢ï¼åˆ/ç²—çœ‹ä¸æ˜æ‰€ä»¥ï¼Œä¸€é¡¿æ“ä½œçŒ›å¦‚è™ï¼ŒæŒ‰ç€ 1. 2. 3. çš„æ­¥éª¤èµ°ï¼Œå½“ç„¶ç»“å±€ä»ä¸€å¼€å§‹å°±å·²ç»æ³¨å®šäº†ï¼åˆ«é—®ï¼é—®å°±æ˜¯ä½ å“ï¼ä½ ç»†ç»†å“ï¼[1]

1. **Delete package-lock.json (not package.json!) and/or yarn.lock in your project folder.**

2. **Delete node_modules in your project folder.**

3. **Remove "babel-eslint" from dependencies and/or devDependencies in the package.json file in your project folder.**

4. **Run npm install or yarn, depending on the package manager you use.**

5. **If you used npm, install yarn (http://yarnpkg.com/) and repeat the above steps with it instead.**

6. **Check if E:\node_modules\babel-eslint is outside your project directory.**

7. **Try running npm ls babel-eslint in your project folder.**

---

## è§£å†³

ä¹Ÿè®¸ä½ ä¹Ÿå¹´å°‘è½»ç‹‚çš„æˆ‘ä¸€æ ·ï¼Œä¸æœè¾“ï¼é‚£å°±å¹²å§ï¼

ç¬¬ä¸€æ¡ï¼Œç›¸ä¿¡è¿™ä¸ªå¤§å®¶éƒ½ä¸é™Œç”Ÿï¼Œå½“é¡¹ç›®çš„ä¾èµ–ä¸‹è½½ä¸ä¸‹æ¥æ—¶ï¼Œè€³è¾¹æ€»ä¼šæœ‰é‚£ä¹ˆä¸€ä¸ªäººä¼šåš·åš·åˆ°â€œåˆ é™¤`yarn.lock`å’Œ`package-lock.json`è¯•ä¸‹â€ã€‚å½“ç„¶è¿™ä¸ªä¸‡é‡‘æ²¹è¿™æ¬¡ç¡®å®ä¸å¥½ä½¿äº†ï¼

æ©ï¼Œç¬¬äºŒæ¡å’Œç¬¬ä¸€æ¡é›·åŒï¼Œ`rm -rf node_modules`  and `yarn` ä¹Ÿè®¸æ˜¯æ•²æ‰“æ¬¡æ•°çš„æœ€å¤šçš„å¯¹è±¡äº†ã€‚

ç¬¬ä¸‰æ¡ï¼Œæåˆ°`babel-eslint`ä¾èµ–å†²çªï¼Œä»`dependencies`ç§»å…¥åˆ°`devDependencies`ä¸­ä¹Ÿè®¸èƒ½è§£å†³ã€‚

ç¬¬å››æ¡ï¼Œ`yarn add babel-eslint` or `npm install babel-eslint` å¯èƒ½æœ‰æ•ˆã€‚

ç¬¬äº”æ¡ï¼Œ`yarn`ä¸è¡Œå°±è¯•è¯•`npm`ï¼Œ`npm`ä¸è¡Œå°±è¯•è¯•`yarn`ã€‚

ç¬¬å…­æ¡ï¼ŒğŸ‘¿ï¼ˆä½ æŠ“ä½å®ƒäº†å—?)ã€‚

ç¬¬ä¸ƒæ¡ï¼Œ`npm ls xxx` ç„¶åå‘¢!

å½“ç„¶ä¸Šè¿°æ–¹æ³•ï¼Œå½“æ—¶éƒ½ä¸€ä¸€è¯•è¿‡ï¼Œå‡æ²¡æˆåŠŸï¼å…¶å®ç¬¬å…­æ¡å·²ç»æ˜ç¡®äº†é—®é¢˜çš„æ‰€åœ¨ï¼åªæ˜¯åæ¥æ²¡æœ‰å¤ç°å‡ºä¸€æ¨¡ä¸€æ ·çš„ä¿¡æ¯ï¼Œä½†ä¹Ÿèƒ½è¯´æ˜é—®é¢˜ã€‚

ä¹‹å‰æ¢äº†ç³»ç»Ÿåï¼Œæ³¨æ„åˆ°äº†æ–‡æœ«:

```js {1}

If nothing else helps, add SKIP_PREFLIGHT_CHECK=true to an .env file in your project.
That would permanently disable this preflight check in case you want to proceed anyway.

```

æ·»åŠ ```.env```,å±…ç„¶å¥æ•ˆäº†ï¼ğŸ¤”

```js
SKIP_PREFLIGHT_CHECK=true 
```

---

ç»†å¿ƒçš„ä½ ä¹Ÿè®¸æ—©å°±å‘ç°äº†ç«¯å€ªï¼š

```js {10}
lerna notice cli v3.22.1
lerna info Executing command in 4 packages: "yarn run dev"
lerna ERR! yarn run dev exited 1 in 'home-app'
lerna ERR! yarn run dev stdout:
$ react-app-rewired start
info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.

lerna ERR! yarn run dev stderr:

There might be a problem with the project dependency tree.

```
æ²¡é”™é—®é¢˜å°±å‡ºåœ¨**`dependency tree`**è¿™é‡Œ[1]:ä¹‹å‰æ— æ„ä¸­æ‹·è´äº†ä¸€ä»½`node_modules`åˆ°é¡¹ç›®çš„ä¸Šä¸€çº§æ–‡ä»¶å¤¹,ä¸€æ®µæ—¶é—´åæŸä¸ªåŒ…æ›´æ–°å¯¼è‡´å½“å‰é¡¹ç›®çš„ä¾èµ–å’Œä¸Šçº§æ–‡ä»¶ä¸­åŒ…çš„ç‰ˆæœ¬å†²çªã€‚

æ˜¾ç„¶åˆ é™¤`yarn.lock`å’Œ`package-lock.json`;`rm -rf node_modules`  and `yarn`; `yarn add xxx`; åˆ‡æ¢`yarn`å’Œ`npm`éƒ½ä¸èƒ½è§£å†³åŒ…çš„ç‰ˆæœ¬å†²çªé—®é¢˜!

---

é‚£ä¹ˆ

* ğŸ¤” `dependency tree` å’Œ `node_modules` æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ
* ğŸ¤” `dependency tree`çš„æŸ¥æ‰¾é¡ºåºæ˜¯æ€æ ·çš„ï¼Ÿ
* ğŸ¤” `npm`åŒ…çš„ç®¡ç†æœºåˆ¶ï¼Œä¸åŒç‰ˆæœ¬æ˜¯å¦æœ‰åŒºåˆ«ï¼Ÿ
* ğŸ¤” `yarn` ä¸ºä»€ä¹ˆå‡ºç°å’Œ `npm` æœ‰ä½•åŒºåˆ«ï¼Ÿ
* ğŸ¤” ä»¥åŠ `deno` ä¸­çš„åŒ…ç®¡ç†å’Œ `node` ä¸­çš„åŒ…ç®¡ç†æœ‰ä½•ä¸åŒï¼Ÿ

## æ‰©å±•



